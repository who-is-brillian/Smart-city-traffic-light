<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fuzzy Traffic Light Control</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      body {
        background-image: url(backiee-121583-landscape.jpg);
        background-size: cover;
      }
      .traffic-light {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 50px;
        flex-wrap: wrap;
        backdrop-filter: blur(2px);
        -webkit-backdrop-filter: blur(2px);
        margin: 30px 300px 50px 300px;
        box-shadow: rgba(0, 0, 0, 0.56) 0px 22px 70px 4px;
      }

      nav {
        background-color: #5b0097;
      }

      .navbar-brand {
        color: #ffff00;
        text-align: center;
      }

      .light-vertical,
      .light-horizontal {
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        position: relative;
      }

      .light-vertical {
        width: 40px;
        height: 100px;
        margin: 10px;
        flex-direction: column;
      }

      .light-horizontal {
        width: 100px;
        height: 40px;
        margin: 10px;
        flex-direction: row;
      }

      .timer {
        top: 60px;
        font-size: 14px;
        color: rgb(0, 0, 0);
      }

      .red {
        background-color: rgb(255, 51, 85);
      }

      .yellow {
        background-color: yellow;
      }

      .green {
        background-color: rgb(101, 255, 101);
      }

      .controls {
        color: #ffff00;
        text-align: center;
        background-color: #5b0097;
        margin: 20px 400px 20px 400px;
        border-radius: 10px;
        padding: 20px;
        box-shadow: rgba(50, 50, 93, 0.25) 0px 30px 60px -12px inset,
          rgba(0, 0, 0, 0.3) 0px 18px 36px -18px inset;
      }

      .controls label {
        display: inline-block;
        width: 120px;
      }

      .controls input {
        width: 50px;
        margin-bottom: 5px;
      }

      /* button */
      button,
      button::after {
        padding: 10px 50px;
        font-size: 20px;
        border: none;
        border-radius: 5px;
        color: white;
        background-color: transparent;
        position: relative;
      }

      button::after {
        --move1: inset(50% 50% 50% 50%);
        --move2: inset(31% 0 40% 0);
        --move3: inset(39% 0 15% 0);
        --move4: inset(45% 0 40% 0);
        --move5: inset(45% 0 6% 0);
        --move6: inset(14% 0 61% 0);
        clip-path: var(--move1);
        content: "GLITCH";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: block;
      }

      button:hover::after {
        animation: glitch_4011 1s;
        text-shadow: 10 10px 10px black;
        animation-timing-function: steps(2, end);
        text-shadow: -3px -3px 0px #1df2f0, 3px 3px 0px #e94be8;
        background-color: transparent;
        border: 3px solid rgb(0, 255, 213);
      }

      button:hover {
        text-shadow: -1px -1px 0px #1df2f0, 1px 1px 0px #e94be8;
      }

      button:hover {
        background-color: transparent;
        border: 1px solid rgb(0, 255, 213);
        box-shadow: 0px 10px 10px -10px rgb(0, 255, 213);
      }

      @keyframes glitch_4011 {
        0% {
          clip-path: var(--move1);
          transform: translate(0px, -10px);
        }

        10% {
          clip-path: var(--move2);
          transform: translate(-10px, 10px);
        }

        20% {
          clip-path: var(--move3);
          transform: translate(10px, 0px);
        }

        30% {
          clip-path: var(--move4);
          transform: translate(-10px, 10px);
        }

        40% {
          clip-path: var(--move5);
          transform: translate(10px, -10px);
        }

        50% {
          clip-path: var(--move6);
          transform: translate(-10px, 10px);
        }

        60% {
          clip-path: var(--move1);
          transform: translate(10px, -10px);
        }

        70% {
          clip-path: var(--move3);
          transform: translate(-10px, 10px);
        }

        80% {
          clip-path: var(--move2);
          transform: translate(10px, -10px);
        }

        90% {
          clip-path: var(--move4);
          transform: translate(-10px, 10px);
        }

        100% {
          clip-path: var(--move1);
          transform: translate(0);
        }
      }
      .peraturan {
        color: #ffff00;
      }
    </style>
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
          <marquee behavior="" direction=""
            ><a class="navbar-brand text-center text-uppercase" href="#">
              <img src="Lambang_Kabupaten_Gresik.png" width="4%" alt="" />
              Implementasi sistem kontrol lampu lalu lintas adaptif berbasis
              logika fuzzy untuk mengurangi kemacetan kota Gresik Perempatan
              Bunder
              <img src="Lambang_Kabupaten_Gresik.png" width="4%" alt="" /></a
          ></marquee>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav"></ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="traffic-light">
      <div id="light2" class="light-horizontal">
        <h3>2</h3>
        <div class="timer" id="timer2">0</div>
      </div>
      <div class="vertical-lights">
        <div id="light1" class="light-vertical red">
          <h3>1</h3>
          <div class="timer" id="timer1">0</div>
        </div>
        <div id="light4" class="light-vertical red">
          <h3>4</h3>
          <div class="timer" id="timer4">0</div>
        </div>
      </div>
      <div id="light3" class="light-horizontal">
        <h3>3</h3>
        <div class="timer" id="timer3">0</div>
      </div>
    </div>
    <div class="controls">
      <label for="cars1">Cars in Lane 1:</label>
      <input type="number" id="cars1" value="30" /><br />
      <label for="cars2">Cars in Lane 2:</label>
      <input type="number" id="cars2" value="70" /><br />
      <label for="cars3">Cars in Lane 3:</label>
      <input type="number" id="cars3" value="90" /><br />
      <label for="cars4">Cars in Lane 4:</label>
      <input type="number" id="cars4" value="40" /><br />
      <button onclick="calculateTraffic()">S T A R T</button>
    </div>
    <p class="text-center peraturan">
      Menurut Undang Undang No. 22 Tahun 2009 tentang Lalu Lintas dan Angkutan
      Jalan (LLAJ), menerangkan Alat Pemberi Isyarat Lalu Lintas (APILL)
      merupakan isyarat lampu yang bisa dilengkapi dengan isyarat bunyi untuk
      mengendalikan arus lalu lintas yang terpasang di persimpangan jalan,
      tempat penyeberangan pejalan kaki dan arus lalu lintas lainnya.
    </p>
    <script>
      let lightInterval;
      let timerInterval;
      let lights = ["light1", "light2", "light3", "light4"];
      let durations = [];
      let currentIndex = 0;
      let yellowDuration = 3; // Duration of the yellow light in seconds

      function calculateTraffic() {
        clearInterval(lightInterval);
        clearInterval(timerInterval);

        let cars1 = parseInt(document.getElementById("cars1").value);
        let cars2 = parseInt(document.getElementById("cars2").value);
        let cars3 = parseInt(document.getElementById("cars3").value);
        let cars4 = parseInt(document.getElementById("cars4").value);

        // Calculate durations using fuzzy logic
        durations[0] = calculateDuration(cars1);
        durations[1] = calculateDuration(cars2);
        durations[2] = calculateDuration(cars3);
        durations[3] = calculateDuration(cars4);

        currentIndex = 0;
        updateLights();
      }

      function calculateDuration(cars) {
        let maxCars = 100; // Assume 100 as the maximum cars for scaling
        let minDuration = 20; // Minimum duration in seconds
        let maxDuration = 60; // Maximum duration in seconds

        // Calculate duration based on the number of cars
        return Math.round(
          minDuration + (cars / maxCars) * (maxDuration - minDuration)
        );
      }

      function updateLights() {
        if (currentIndex >= lights.length) {
          currentIndex = 0;
        }

        // Set the current light to green and start the timer
        lights.forEach((light, index) => {
          let lightElement = document.getElementById(light);
          let timerElement = document.getElementById("timer" + (index + 1));
          if (index === currentIndex) {
            lightElement.className =
              light.includes("1") || light.includes("4")
                ? "light-vertical green"
                : "light-horizontal green";
            startTimer(timerElement, durations[currentIndex]);
          } else {
            lightElement.className =
              light.includes("1") || light.includes("4")
                ? "light-vertical red"
                : "light-horizontal red";
            timerElement.innerHTML = 0;
          }
        });

        // Set the next light to yellow after the green duration
        lightInterval = setTimeout(() => {
          lights.forEach((light, index) => {
            if (index === currentIndex) {
              let lightElement = document.getElementById(light);
              lightElement.className =
                light.includes("1") || light.includes("4")
                  ? "light-vertical yellow"
                  : "light-horizontal yellow";
              let timerElement = document.getElementById("timer" + (index + 1));
              startTimer(timerElement, yellowDuration);
            }
          });

          // Change the light to red and move to the next light after the yellow duration
          lightInterval = setTimeout(() => {
            lights.forEach((light, index) => {
              document.getElementById(light).className =
                light.includes("1") || light.includes("4")
                  ? "light-vertical red"
                  : "light-horizontal red";
              document.getElementById("timer" + (index + 1)).innerHTML = 0;
            });

            currentIndex++;
            updateLights();
          }, yellowDuration * 1000);
        }, durations[currentIndex] * 1000);
      }

      function startTimer(timerElement, duration) {
        let timeLeft = duration;
        timerElement.innerHTML = timeLeft;

        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          timerElement.innerHTML = timeLeft;
          if (timeLeft <= 0) {
            clearInterval(timerInterval);
          }
        }, 1000);
      }

      document.addEventListener("DOMContentLoaded", () => {
        calculateTraffic();
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
